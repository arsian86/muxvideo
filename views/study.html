<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <title>ä¸Šèª²é é¢ - Sportify+</title>
    <script src="https://cdn.jsdelivr.net/npm/@mux/mux-player"></script>
    <style>
      /* ğŸ¯ è¨­å®šæ’­æ”¾å™¨å°ºå¯¸ */
      #muxPlayer {
        width: 100%; /* å¯¬åº¦ä½”æ»¿å®¹å™¨ */
        height: 500px; /* å›ºå®šé«˜åº¦ */
        max-width: 1200px; /* æœ€å¤§å¯¬åº¦é™åˆ¶ */
        border-radius: 8px; /* åœ“è§’ */
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); /* é™°å½± */
      }

      /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
      @media (max-width: 768px) {
        #muxPlayer {
          height: 250px; /* æ‰‹æ©Ÿç‰ˆè¼ƒå°é«˜åº¦ */
        }
      }

      /* å®¹å™¨æ¨£å¼ */
      .video-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }
    </style>
  </head>
  <body>
    <h1>ä¸Šèª²é é¢</h1>
    <main style="flex: 1; padding-left: 20px">
      <h2 id="video-title">è¼‰å…¥ä¸­...</h2>
      <mux-player id="muxPlayer" controls></mux-player>
    </main>
    <script>
      //userç™»å…¥token,è«‹è¨˜å¾—æ›¿æ›ç‚ºæ­£ç¢ºåƒæ•¸
      const token =
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImE4OGIyMTMxLWY2MzgtNDEwMC1hMTM5LTMwMDZlYzA2N2ZkZSIsInJvbGUiOiJVU0VSIiwiaWF0IjoxNzQ5MjExNTAzLCJleHAiOjE3NTE4MDM1MDN9.ER7dKXK-mPG17yeZ9OPwGvYn-TxD_Egkh6IqYSNrglI";
      async function loadVideo(chapterId) {
        try {
          //æœ¬åœ°æ¸¬è©¦è«‹æ”¹æˆlocalhost:3000,æ­é…ngrokæˆ–å…¶ä»–å·¥å…·æ¥å—webhooké€šçŸ¥
          const API = `https://sportify.zeabur.app/api/v1/users/courses/${chapterId}/video-player`;

          // å‘¼å«å¾Œç«¯APIå–å¾—å½±ç‰‡æ’­æ”¾è³‡è¨Š
          const res = await fetch(API, {
            headers: {
              Authorization: `Bearer ${token}`,
              "Content-Type": "application/json",
            },
          });
          const response = await res.json();
          console.log(response);
          const { streamUrl, chapter_subtitle } = response.data;
          document.getElementById("video-title").textContent = chapter_subtitle;
          const player = document.getElementById("muxPlayer");
          player.src = streamUrl;
        } catch (error) {
          alert("å½±ç‰‡è¼‰å…¥å¤±æ•—ï¼š" + error.message);
        }
      }

      window.onload = () => {
        //è«‹è¨˜å¾—æ›¿æ›ç‚ºæ­£ç¢ºçš„chapterId
        const chapterId = "81b61daa-e16a-4eaf-85a6-5eca84d6f978";
        loadVideo(chapterId);
      };
    </script>
  </body>
</html>
